# Задание для студентов

Цель: расширить и улучшить существующий WebSocket чат-клиент и тестовый сервер, добавив конфигурацию, обработку сообщений, простую аутентификацию и сохранение истории.

Общее требование
- Работать с репозиторием WebSocketChatClient.
- Изменения должны быть минимальными и аккуратно документированы.

Основные задачи (обязательные)
1. Вынести адрес/порт сервера в конфигурацию
   - Добавьте чтение адреса/порта из `app.config` или из параметров командной строки в клиенте.
   - По умолчанию сохраняйте текущее значение из `Program.cs`.
   - Критерий приёмки: клиент подключается к адресу из конфигурации без правки исходников.

2. Сохранение истории сообщений на клиенте
   - Сохранять последние 100 сообщений в JSON-файле (например, `history.json`).
   - При запуске загружать историю и показывать её в консоли.
   - Критерий приёмки: после перезапуска клиент показывает сохранённую историю.

3. Валидация формата сообщений
   - Установите простой JSON-схемоподобный контроль: сообщения должны иметь поля `sender`, `text`, `timestamp`.
   - Игнорируйте и логируйте некорректные сообщения.
   - Критерий приёмки: сервер или тесты отправляют некорректное тело — клиент не падает и выводит предупреждение.

4. Простая аутентификация (технически минимальная)
   - Добавьте в клиент поддержку передачи токена при подключении (в заголовке или параметре URL).
   - Измените `websocket-server/server.js` чтобы он принимал или отвергал подключения без правильного токена (тестовый токен можно хранить прямо в файле сервера).
   - Критерий приёмки: подключение с правильным токеном проходит, без — отклоняется.

5. Команды клиента
   - Реализуйте в консоли клиентa базовые команды: `/nick <name>` — смена ника, `/history` — показать историю, `/quit` — выход.
   - Критерий приёмки: команды работают интерактивно.

Дополнительные (опционально):
- Поддержка комнат (join/leave) на сервере и клиента.
- Поддержка TLS (сертификат для сервера) или запуск через wss://.
- Интерфейс GUI (WinForms/WPF) вместо консоли.

Требуемые изменения в кодовой базе
- Клиент: `WebSocketChatClient/Program.cs` — чтение конфигурации, команды и логика сохранения истории.
- Клиент: добавьте `app.config` при необходимости или используйте `dotnet user-secrets`/параметр командной строки.
- Сервер: `websocket-server/server.js` — проверка токена и тестовые сценарии.

Тестирование и запуск (рекомендации)
1) Запустить сервер (в каталоге `websocket-server`):

```powershell
cd websocket-server
npm install
node server.js
```

2) Запустить клиент (в каталоге `WebSocketChatClient`):

```powershell
cd WebSocketChatClient
dotnet build
dotnet run --project WebSocketChatClient.csproj -- <опции>
```

Формат сдачи
- Пул-реквест или архив с изменениями.
- В описании укажите: какие пункты выполнены, какие нет, и как запустить ваши изменения.
